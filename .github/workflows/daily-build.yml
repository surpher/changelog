# on:
  # push:
    # Sequence of patterns matched against refs/tags
    # tags:
      # - 'build-number-*' # Push events to matching build-number-, i.e. build-number-229
on: push

name: Daily build changelog

jobs:
  build_number:
    runs-on: ubuntu-latest
    outputs:
        build_number: ${{ steps.buildnumber.outputs.build_number }}
    
    steps:
      - name: "#️⃣ Generate Build Number"
        id: buildnumber
        uses: einaregilsson/build-number@v2
        with:
            token: ${{ secrets.github_token }}


  build:
    name: "🧪 Create changelog"
    runs-on: ubuntu-latest
    needs: [build_number]

    steps:
      - uses: actions/checkout@v1
        
      - name: "⚠️ Show buildnumber tag"
        run: | 
          echo "🚨 Build Number: " + ${{ steps.buildnumber.output.build_number }}

      - name: "🗒 Generate changelog"
        uses: heinrichreimer/action-github-changelog-generator@v2.1.1
        id: generate_changelog
        with:
          token: ${{ secrets.github_token }}            
          sinceTag: "build-number-${{ steps.buildnumber.output.build_number }}"
          stripHeaders: "true"
          stripGeneratorNotice: "true"

